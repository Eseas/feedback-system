<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:p="http://primefaces.org/ui"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
      xmlns:f="http://xmlns.jcp.org/jsf/core"
      xmlns:o="http://omnifaces.org/ui"
>
<f:view>
    <f:metadata>
        <f:viewParam name="id" value="#{createSurveyController.id}"/>
        <f:viewParam name="modify" value="#{createSurveyController.modify}"/>
        <o:viewAction action="#{createSurveyController.loadData}" rendered="#{param.modify ne null}"/>
    </f:metadata>

    <h:head>
        <meta charset="utf-8" />
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css"/>
        <link href='https://fonts.googleapis.com/css?family=Roboto:300,400,700' rel='stylesheet' type='text/css'/>
        <link href="https://fonts.googleapis.com/css?family=Josefin+Sans" rel="stylesheet"/>
        <link href="https://fonts.googleapis.com/css?family=Bitter" rel="stylesheet"/>
        <h:outputStylesheet name="css/stylesCreate.css" />
        <title>Builder of Surveys </title>
    </h:head>

    <h:body>

        <div class="top-bar">
            <ol class="header">
                <li id="logo"><h1>B<em>o</em>S</h1></li>
                <li id="user">
                    <span class="glyphicon glyphicon-user throwLeft"/>
                    <p:outputLabel class="throwLeft" value="#{userController.fullName}" style="font-weight: normal; margin-right: 5px"/>
                    <h:form class="throwLeft">
                        <h:commandLink value=" (Logout)" action="#{loginController.doLogout()}"/>
                    </h:form>
                </li>
            </ol>
        </div>

        <div class="page_title">
            <h2>Create Survey</h2>

            <h:form id="definition_form" class="form clearfix">
                <div class="throw-left clearfix">
                    <p:inputText id="title" placeholder="Title" value="#{createSurveyController.survey.title}"/>
                    <p:message for="title"/>

                    <p:inputText id="description" placeholder="Description" value="#{createSurveyController.survey.description}"/>
                    <p:message for="description"/>
                </div>

                <div class="throw-right clearfix">
                    <p:selectOneButton value="#{createSurveyController.survey.confidential}">
                        <f:selectItem itemLabel="Private" itemValue="true" />
                        <f:selectItem itemLabel="Public" itemValue="false" />
                    </p:selectOneButton>
                </div>
            </h:form>
        </div>

        <p:tabView dynamic="true" cache="true">
            <p:tab title="Page 1">

        <h:form id="creation_form">
            <p:fieldset>
                <!-- Could use loop var for position -->
                <ui:repeat value="#{createSurveyController.questions}" var="question">
                    <p:outputLabel for="questionTitle" value="#{question.getPosition().toString()}"/>
                    <h:inputText id="questionTitle" value="#{question.title}"/>
                    <h:commandButton value="remove" actionListener="#{createSurveyController.removeQuestion(question)}"/>
                    <h:commandButton value="up" actionListener="#{createSurveyController.moveUp(question)}"/>
                    <h:commandButton value="down" actionListener="#{createSurveyController.moveDown(question)}"/>

                    <p:selectOneButton value="#{question.required}">
                        <f:selectItem itemLabel="Required" itemValue="true" />
                        <f:selectItem itemLabel="Optional" itemValue="false" />
                    </p:selectOneButton>
                    <br/>

                    <!-- TextQuestion -->
                    <ui:fragment rendered="#{question.type == 'TextQuestion'}">

                    </ui:fragment>


                    <!-- SliderQuestion-->
                    <ui:fragment rendered="#{question.type == 'SliderQuestion'}">
                        <p:outputLabel for="lowerBound" value="Lower bound"/>
                        <p:inputText id="lowerBound" value="#{question.lowerBound}"/>
                        <p:message for="lowerBound"/>

                        <p:outputLabel for="upperBound" value="Upper bound"/>
                        <p:inputText id="upperBound" value="#{question.upperBound}"/>
                        <p:message for="upperBound"/>
                    </ui:fragment>


                    <!-- RadioQuestiontion -->
                    <ui:fragment rendered="#{question.type == 'RadioQuestion'}">
                        <h:dataTable value="#{question.radioButtons}" var="radioButton">
                            <h:column>
                                <p:outputLabel for="radioButtonTitle" value="Radio Button"/>
                                <h:inputText id="radioButtonTitle" value="#{radioButton.title}" />
                                <h:commandButton value="remove" action="#{createSurveyController.removeRadioButton(question, radioButton)}"/>
                                <p:message for="radioButtonTitle"/>
                            </h:column>
                        </h:dataTable>
                        <h:commandButton value="add radio button" actionListener="#{createSurveyController.addRadioButton(question)}" />

                    </ui:fragment>

                    <!-- CheckboxQuestiontion -->
                    <ui:fragment rendered="#{question.type == 'CheckboxQuestion'}">
                        <h:dataTable value="#{question.checkboxes}" var="checkbox">
                            <h:column>
                                <p:outputLabel for="checkboxTitle" value="Checkbox"/>
                                <h:inputText id="checkboxTitle" value="#{checkbox.title}" />
                                <h:commandButton value="remove" action="#{createSurveyController.removeCheckbox(question, checkbox)}"/>
                                <p:message for="checkboxTitle"/>
                            </h:column>
                        </h:dataTable>
                        <h:commandButton value="add option value" actionListener="#{createSurveyController.addCheckbox(question)}" />

                    </ui:fragment>

                    <br/>
                    <p:message for="questionTitle"/>
                </ui:repeat>
            </p:fieldset>

            <h:commandButton value="add text question" actionListener="#{createSurveyController.addTextQuestion()}" />
            <h:commandButton value="add slider question" actionListener="#{createSurveyController.addSliderQuestion()}" />
            <h:commandButton value="add radio question" actionListener="#{createSurveyController.addRadioQuestion()}" />
            <h:commandButton value="add checkbox question" actionListener="#{createSurveyController.addCheckboxQuestion()}" />
            <!-- Ending creation -->
            <br/>

            <ui:fragment rendered="#{empty createSurveyController.modify}">
                <h:commandButton value="save" action="#{createSurveyController.create()}" />
            </ui:fragment>

            <ui:fragment rendered="#{createSurveyController.modify == true}">
                <h:commandButton value="save" action="#{createSurveyController.update()}" />
            </ui:fragment>
            <p:messages globalOnly="true"/>
        </h:form>
            </p:tab>
            <p:tab title="Add new +">
            </p:tab>
        </p:tabView>
    </h:body>
</f:view>

</html>

